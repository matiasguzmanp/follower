<?xml version="1.0" encoding="UTF-8"?>
<launch>
    <param name="robot_description" command="$(find xacro)/xacro '$(find follower_description)/robots/follower.urdf'" />

    <arg name="x" default="0.0"/>
    <arg name="y" default="0.0"/>
    <arg name="z" default="0.2"/>

    <node name="follower_spawn" pkg="gazebo_ros" type="spawn_model" 
        args="-urdf -param robot_description -model follower -x $(arg x) -y $(arg y) -z $(arg z)" />

    <group ns="tulio/camera">
        <node pkg="nodelet" type="nodelet" name="nodelet_manager" args="manager" />

        <node pkg="nodelet" type="nodelet" name="nodelet1"
                args="load depth_image_proc/register nodelet_manager">
            <remap from="rgb/camera_info" to="color/camera_info"/>
            <remap from="depth/camera_info" to="depth/camera_info"/>
            <remap from="depth/image_rect" to="depth/image_raw"/>
            <remap from="depth_registered/camera_info" to="aligned_depth_to_color/camera_info"/>
            <remap from="depth_registered/image_rect" to="aligned_depth_to_color/image_raw"/>
        </node>

        <node pkg="nodelet" type="nodelet" name="nodelet2"
                args="load depth_image_proc/point_cloud_xyzrgb nodelet_manager">
            <remap from="rgb/image_rect_color" to="color/image_raw"/>
            <remap from="rgb/camera_info" to="color/camera_info"/>
            <remap from="depth_registered/camera_info" to="aligned_depth_to_color/camera_info"/>
            <remap from="depth_registered/image_rect" to="aligned_depth_to_color/image_raw"/>
            <remap from="depth_registered/points" to="depth/color/points"/>
        </node>
    </group>


    <node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher" />
    <node name="joint_state_publisher" pkg="joint_state_publisher" type="joint_state_publisher" />

</launch>